---
name: 《JavaScript设计模式与开发实践》学习笔记（十一）
title: 《JavaScript设计模式与开发实践》学习笔记（十一）
tags: ["技术","学习笔记","JavaScript设计模式与开发实践"]
categories: 学习笔记
info: "第二部分、第 17 章 适配器模式 || 第三部分、第 18 章 单一职责原则、第 19 章 最少知识原则、第 20 章 开放-封闭原则"
time: 2019/10/5,
desc: 'JavaScript设计模式与开发实践, 资料下载, 学习笔记'
keywords: ['JavaScript设计模式与开发实践资料下载', '前端', '学习笔记']
---

# 《JavaScript设计模式与开发实践》学习笔记（十一）

## 第 17 章 适配器模式

适配器模式的作用是解决两个接口不兼容的问题。这是一种相对简单的模式，主要目的就是通过一个或几个函数或者类，将某种格式转换为另一种格式。该模式本节不详细描述。

---

**第三部分 设计原则和编程技巧**

在第二部分中我们已经学习了常用的 JavaScript 设计模式，在该部分，我们将学习一些面向对象的设计原则。

> 前辈总结的这些设计原则通常指的是单一职责原则、里氏替换原则、依赖倒置原则、接口隔 离原则、合成复用原则和最少知识原则    

---

## 第 18 章 单一职责原则

> 单一职责原则（SRP）的职责被定义为“引起变化的原因”。如果我们有两个动机去改写一 个方法，那么这个方法就具有两个职责。每个职责都是变化的一个轴线，如果一个方法承担了过 多的职责，那么在需求的变迁过程中，需要改写这个方法的可能性就越大    

单一职责原则更多地被运用在对象或者方法级别上，因此我们的讨论大多基于对象和方法。

### 18.1 设计模式中的 SRP 原则

SRP 原则在很多设计模式中都有着广泛运用，如代理模式、迭代器模式、单例模式和装饰器模式。

而 SRP 原则的应用难点就是如何去分离职责。

### 18.2 何时应该分离职责

需要明确的是，并不是所有的职责都应该一一分离。

- 如果随着需求变化，有两个职责总是同时变化，那就不必分离他们。比如说在 ajax 请求的时候，创建 xhr 对象和发送 xhr 请求几乎总是在一起，那么这两个职责功能就没有必要分开。
- 职责的变化仅当它们确定会发生变化时才具有意义，即便两个职责是耦合的，但它们还没有发生改变的征兆，那就没有必要主动分离它们，而可以等到需要重构的时候再进行分离。

### 18.4 SRP 原则的优缺点

SRP 原则的优点是降低了单个类或者对象的复杂度，按照职责把对象分解成更小的粒度。而缺点则是会明显增加代码的复杂度和增大了这些对象之间互相联系的难度。

## 第 19 章 最少知识原则

最少知识原则（LKP）要求我们在设计程序时，应当尽量减少对象之间的交互。如果两个对象之间不必彼此直接通信，那么这两个对象就不要发生直接的相互联系。

### 19.1 设计模式中的最少知识原则

单一职责原则让我们把对象划分成较小的粒度以提高对象的复用性，但是越来越多的对象反而会有可能产生更为复杂的耦合关系，以至于到后面修改其中一个对象就会影响到与其关联的其它对象，降低可复用性。

在设计模式中，体现该原则最多的是中介者模式和外观模式。

- 中介者模式通过增加一个中介者对象，让所有的相关对象都通过中介者来进行通信而不是互相引用

- 外观模式在第二部分中并没有提到，因为这种模式在 JavaScript 中的使用场景并不多，外观模式的意思是一组指令集，通过对一些底层方法的封装来实现一个高阶的方法，如下就实现了一个最简单的外观模式：

  ```javascript
  function a1 () {console.log('a1')}
  function a2 () {console.log('a2')}
  
  function b1 () {console.log('b1')}
  function b2 () {console.log('b2')}
  
  function A () {
    a1()
    a2()
  }
  
  function B () {
    b1()
    b2()
  }
  
  function facade () {
    A()
    B()
  }
  
  facade()
  ```

> 虽然遵守最小知识原则减少了对象之间的依赖，但也有可能增加一些庞大到难 以维护的第三者对象。跟单一职责原则一样，在实际开发中，是否选择让代码符合最少知识原则， 要根据具体的环境来定。    

## 第 20 章 开放-封闭原则

> 在面向对象的程序设计中，开放 - 封闭原则（OCP）是最重要的一条原则。很多时候，一个程序具有良好的设计，往往说明它是符合开放封闭原则的    

开放封闭的原则定义为：软件实体（类、模块、函数）等应该是可以扩展的，但是不可修改。几乎所有的设计模式都需要遵守这个原则。

### 20.3 用对象的多态性消除条件分支

过多的条件分支语句是造成程序违反开放 - 封闭原则的一个常见原因，使用对象的多态性让程序遵守开放 - 封闭原则是一个常用的技巧。

### 20.4 找出变化的地方

> 开放封闭原则是一个看起来比较虚幻的原则，并没有实际的模板教导我们怎样亦步亦趋地 实现它。但我们还是能找到一些让程序尽量遵守开放封闭原则的规律，最明显的就是找出程序 中将要发生变化的地方，然后把变化封装起来。    

有下面几种方式可以帮助我们编写遵守开放封闭原则的代码：

- 放置挂钩(hook)，在某些容易变化的地方放置钩子，返回结构由具体的子类决定，使程序拥有了变化的可能性。
- 使用回调函数，回调函数也是一种特殊的钩子

### 20.6 开放 - 封闭原则的相对性





> 本次阅读至 P270  20.6 开放 - 封闭原则的相对性 289