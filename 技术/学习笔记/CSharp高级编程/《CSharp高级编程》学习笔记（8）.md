---
name: 《C#高级编程》学习笔记（8）
title: 《C#高级编程》学习笔记（8）
tags: ["技术","学习笔记","C#高级编程"]
categories: 学习笔记
info: "C#高级编程 第8章 委托、lambda表达式"
time: 2023/7/22
desc: 'C#高级编程, 学习笔记, 第8章 委托、lambda表达式'
keywords: ['学习笔记', 'C#', 'C#高级编程', '第8章 委托、lambda表达式']

---

#  《C#高级编程》学习笔记（8）

## 第8章 委托、lambda表达式

### 8.1 引用方法

在 C++ 中，函数指针只是一个指向内存位置的指针，并不是类型安全的，也无法判断这个指针实际上指向什么，参数和返回类型等更加无从知晓。

而 C# 的委托虽然也是一种函数指针寻址方法，但它定义了返回类型和参数的类型，不仅包含对单个方法的引用，也可以包含对多个方法的引用，因此是类型安全的。

而 lambda 与委托直接相关，当参数是委托类型，就可以使用 lambda 表达式实现委托引用的方法。

### 8.2 委托

当要把方法传送给其他方法时，就需要使用委托。在 C 和 C++ 中，只能提取函数的地址并作为一个参数传递它。但这样做除了一些类型安全的问题外，还忽略了一点：**在进行面向对象编程时，几乎没有方法是孤立存在的**。所以在 C# 中，如果要传递方法，就必须把方法的细节封装在一种新的对象类型中，即委托。

委托只是一种特殊类型的对象，其特殊之处在于，我们以前定义的所有的对象都包含数据，而委托包含的只是一个或多个方法的地址。

```csharp
delegate void IntMethodInvoker(int x);
```

上面的示例中，声明了一个委托 IntMethodInvoker 类，在定义委托时，必须给出它所表示的方法的签名和返回类型等全部细节。

```csharp
private delegate string GetAString();
public static void Main()
{
  int x = 40;
  GetAString firstStringMethod = new GetAString(x.ToString);
  Console.WriteLine($"String is {firstStringMethod()}");
}
```

#### 8.2.4 Action\<T\>和Func\<T\>委托

> chatGPT：
>
> Q：举例详细介绍C#中的 Action 委托和 Func 委托？
>
> A：在 C# 中，Action 委托和 Func 委托是两种常用的委托类型，用于封装方法或 Lambda 表达式。它们可以简化代码，并提供了一种方便的方式来传递方法作为参数或从方法返回结果。
>
> Action 委托是一个不返回值的委托类型。它可以接受最多 16 个参数，并且不返回任何结果。以下是一个示例：
>
> ```csharp
> // 定义一个 Action 委托，接受两个整数参数
> Action<int, int> add = (x, y) =>
> {
>     int sum = x + y;
>     Console.WriteLine($"Sum: {sum}");
> };
> 
> // 调用 Action 委托
> add(5, 3);  // 输出：Sum: 8
> ```
>
> 在上面的示例中，我们定义了一个接受两个整数参数的 Action 委托，并使用 Lambda 表达式定义了它的具体实现。然后，我们通过调用委托来执行该方法，并打印出结果。
>
> Func 委托是一个具有返回值的委托类型。它可以接受最多 16 个参数，并返回一个指定类型的结果（最后一个泛型参数表示返回值的类型）。以下是一个示例：
>
> ```csharp
> // 定义一个 Func 委托，接受两个整数参数，并返回它们的和
> Func<int, int, int> add = (x, y) =>
> {
>     return x + y;
> };
> 
> // 调用 Func 委托
> int sum = add(5, 3);
> Console.WriteLine($"Sum: {sum}");  // 输出：Sum: 8
> ```
>
> 在上面的示例中，我们定义了一个接受两个整数参数并返回它们的和的 Func 委托。我们使用 Lambda 表达式定义了它的具体实现。然后，我们通过调用委托来执行该方法，并将结果存储在变量 `sum` 中，并打印出结果。
>
> 总结一下，Action 委托用于封装不返回值的方法，而 Func 委托用于封装具有返回值的方法。它们都可以简化代码，并提供了一种方便的方式来传递方法作为参数或从方法返回结果。

#### 8.2.6 多播委托









> 本次阅读至 P212  8.2.6 多播委托 下次阅读应至 P227

