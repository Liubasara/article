---
name: 红宝书学习笔记（九）
title: 红宝书（javascirpt高级程序设计）学习笔记（九）
tags: ['读书笔记', '红宝书', 'javascript高级程序设计']
categories: 学习笔记
info: "人类的好伙伴，红宝书（九）"
time: 2019/2/4
desc: 'javascirpt高级程序设计, 红宝书, 资料下载, 学习笔记, 第13章'
keywords: ['前端', '红宝书笔记', '学习笔记', '第13章 事件']
---

# 红宝书（javascirpt高级程序设计）学习笔记（九）

## 第13章 事件

**本章开始开始介绍浏览器的事件，在开发中十分常用，建议认真阅读，查缺补漏，做好笔记。**

`JavaScript`与`HTML`之间的交互是通过**事件**来实现的。**所谓事件，就是文档或浏览器窗口中发生的一些特定的交互瞬间**。可以使用侦听器来预订事件，以便事件发生时执行相应的代码。

### 13.1 事件流

事件流描述的是从页面中接收事件的顺序，有两种主流的事件流，一种是IE的**事件冒泡流**，而另一种是Netscape的**事件捕获流**。

#### 13.1.1 事件冒泡

IE的事件流叫作事件冒泡（event bubbling），即事件开始时由最具体的元素接收，然后逐级向上传播到较为不具体的节点。简单来说，就是从某个具体的按钮一直冒泡到`document`元素（有的会一直冒泡到`window`对象）。

多数浏览器都是这种事件流。

#### 13.1.2 事件捕获

事件捕获则与上面的思路直接相反，会从`document`一直传播到实际的目标。由于老版本的浏览器不支持，因此很少有人会使用事件捕获。

#### 13.1.3 DOM事件流

"DOM2级事件"规定的事件流包括3个阶段：

- 事件捕获阶段
- 处于目标阶段
- 事件冒泡阶段

在DOM事件流中，实际的目标在捕获阶段不会接收到事件，这意味着在捕获阶段，事件从`document`到`<html>`再到`<body>`后就停止了。下一个阶段是“处于目标”阶段，于是事件在`<div>`上发生，**并在事件处理中被看成冒泡阶段的一部分**。然后，冒泡阶段发生，事件又传播回文档。

### 13.2 事件处理程序

响应某个事件的函数叫作**事件处理程序**（或**事件监听器**）。事件处理程序的名字以"on"开头。为事件指定处理程序的方式有好几种。

#### 12.2.1 HTML事件处理程序

你可以直接在标签里声明事件处理程序，如下

```html
<input type="button" value="click me" onclick="alert('click')"/>
```

这个操作是通过`onclick`特性并将一些JavaScript代码作为它的值来定义的。由于这个值时JavaScript，因此不能在其中使用未经转义的HTML语法字符，如&、""、<、>这些。如上面的代码，如果想要使用双引号，就要改成

```html
<input type="button" value="click me" onclick="alert(&quot;click&quot;)"/>
```

除了以上的方法外，你还可以调用在页面其它地方定义的脚本

```html
<script>
    function showMessage () {
        alert("Hello World !!")
    }
</script>
<input type="button" value="click me" onclick="showMessage()"/>
```

 上面这样指定时间处理程序，会创建一个封装这元素值的函数。这个函数中有一个局部变量`event`，也就是事件对象，通过`event`变量，可以直接访问事件对象。而且在这个函数内部，`this`值等于事件的目标元素。

#### 13.2.2 DOM 0级事件处理程序

每个元素（包括`document`和`window`）都有自己的事件处理程序属性，这些属性通常全部小写，例如`onclick`。将这种属性的直射为一个函数，就可以指定事件的处理程序。

```javascript
var btn = document.getElementById("myBtn")
btn.onclick = function () {
    alert("clicked !")
}
btn.onclick = null // 通过设置为null来删除事件处理程序
```

使用DOM 0级指定方法指定的事件处理程序被认为是元素的方法。因此，这时候的事件处理程序实在元素的作用域中运行的。**换句话说，函数的this引用的就是当前元素**。

#### 13.2.3 DOM2级事件处理程序

与DOM 0级方法一样，这种方式的添加的事件处理程序也是依附在其元素的作用域中运行的。其好处就是可以添加多个事件处理程序。

```javascript
var btn = document.getElementById('myBtn')
btn.addEventListener('click', function () {
    alert(this.id)
}, false)
btn.addEventListener('click', function () {
    alert('hello')
}, false)
// 两个事件会按照添加它们的顺序触发
```

`addEventListener`接收一个函数和一个布尔值，最后这个布尔值参数如果为`true`，表示在捕获阶段调用该处理程序；如果为`false`，表示在冒泡阶段调用事件处理程序。默认为`false`。

**通过`addEventListener()`添加的事件处理程序只能使用`removeEventListner()`来移除**，而这也意味着通过`addEventListener()`添加的**匿名函数**将无法移除。

**大多数情况下，都是将事件处理程序添加到事件流的冒泡阶段，以便最大限度地兼容各种浏览器**。

#### 13.2.4 IE事件处理程序

> 本次阅读至P352 IE事件处理程序