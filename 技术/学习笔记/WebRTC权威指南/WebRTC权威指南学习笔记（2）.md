---
name: WebRTC权威指南学习笔记（2）
title: WebRTC权威指南学习笔记（2）
tags: ["技术","学习笔记","WebRTC权威指南"]
categories: 学习笔记
info: "第2章 如何使用 WebRTC"
time: 2021/4/7
desc: 'WebRTC权威指南, 资料下载, 学习笔记'
keywords: ['WebRTC权威指南', 'WebRTC', '学习笔记']
---

# WebRTC权威指南学习笔记（2）

## 第2章 如何使用 WebRTC

WebRTC 只需要少数几个步骤即可建立媒体会话。本章将大体介绍如何建立 WebRTC 对话，会话期间可执行哪些操作，以及如何关闭会话等。

### 2.1 建立 WebRTC 会话

建立 WebRTC 需要四个主要步骤：

1. 获取本地媒体

   最常见的是使用`getUserMedia()`方法，此方法可用于获取单个本地 MediaStream。在获取一个或多个媒体流之后，可使用 MediaStream API 将它们组合到所需要的流中。为保护隐私，浏览器会在请求用户许可后，才批准 Web 应用程序访问用户的麦克风或摄像头。

2. 在浏览器和对等端（其他浏览器或终端）之间建立连接

   RTCPeerConnection API 是 WebRTC 的核心，用于在两个对等端之间建立连接。建立次连接需要一个新的 RTCPeerConnection 对象，该构造函数方法需要传入一个配置对象，用于配置 ICE 和 NAT 和防火墙。

3. 将媒体和数据通道关联至该连接

   建立连接后，可将任意数量的本地媒体流关联到对等连接，以通过该连接发送至远端浏览器。也可以将任意数量的远端媒体流发送至对等连接的本地端。

4. 交换会话描述

   当从本地端或远程端发出添加或删除媒体的请求时，可请求浏览器生成相应的 RTCSessionDescription 对象，用于表示通过对等连接传输的所有媒体集合。当两个对等连接的浏览器交换完 RTCSessionDescription 对象后，即可建立媒体或数据会话，两个浏览器将开始配置 NAT 打洞。NAT 完毕后即可开始协商密钥，确保媒体会话的安全。最后才会开始媒体或数据会话。

![2-1.png](./images/2-1.png)

![2-2.png](./images/2-2.png)

#### 2.1.4 关闭连接

对等连接中，任何一端的浏览器都可以关闭连接。应用程序可以通过对 RTCPeerConnection 对象调用`close()`来指示连接已使用完毕。

### 2.2 WebRTC 联网和交互示例

![2-3.png](./images/2-3.png)

#### 2.2.1 在 WebRTC 三角形中建立会话











> 本地阅读至 P14 2.2.1 在 WebRTC 三角形中建立会话 33